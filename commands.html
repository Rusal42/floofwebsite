<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Floofs Den ‚Äî Commands & Help</title>
  <meta name="description" content="Full commands and setup help for Floofs Den Discord bot." />
  <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üêæ</text></svg>">
  <link rel="stylesheet" href="/styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    /* Light variant of the category toolbar for quick nav */
    .quickbar {
      display:flex; align-items:center; gap:12px;
      background: rgba(255,255,255,0.8);
      border: 1px solid rgba(0,0,0,0.06);
      border-radius: 14px;
      padding: 8px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.05);
      backdrop-filter: blur(6px);
    }
    .quickbar-scroll{ flex:1 1 auto; display:flex; gap:12px; overflow:auto; scrollbar-width:none; cursor: grab; user-select:none; -webkit-overflow-scrolling: touch; }
    .quickbar-scroll::-webkit-scrollbar{ display:none; }
    .quickbar-scroll.dragging { cursor: grabbing; }
    .quickbar .cx-chip {
      display:inline-flex; align-items:center; gap:8px;
      border-radius: 10px;
      padding: 8px 12px;
      background: #fff;
      border: 1px solid rgba(0,0,0,0.06);
      color:#2b2b2b; text-decoration:none; font-weight:500;
      white-space:nowrap;
      transition: background .2s ease, border-color .2s ease, box-shadow .2s ease;
    }
    .quickbar a { -webkit-user-drag: none; }
    .quickbar .cx-chip .icon { opacity:.85; }
    .quickbar .cx-chip:hover { background:#f7f7f9; border-color: rgba(0,0,0,0.12); }
    .quickbar .cx-chip.active { background:#eef2ff; border-color:#c7d2fe; color:#1f2937; }

    /* Quickbar search button + popover */
    .qb-search{
      position:absolute; right:8px; top:8px;
      width:36px; height:36px; border-radius:10px; border:1px solid rgba(0,0,0,0.06);
      background:#fff; color:#4b5563; display:inline-flex; align-items:center; justify-content:center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      z-index:2;
    }
    .qb-search:hover{ background:#f7f7f9; }
    .qb-popover{ position:absolute; right:8px; top:52px; background:#fff; border:1px solid rgba(0,0,0,0.08); border-radius:12px; padding:8px; box-shadow:0 8px 24px rgba(0,0,0,0.12); }
    .qb-popover input{ width:260px; padding:10px 12px; border:1px solid rgba(0,0,0,0.12); border-radius:10px; outline:none; }

    /* Count badge under section headings */
    .section-count{ margin-top:6px; color:#6b7280; font-size:12px; }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-brand">
        <span class="nav-logo">üêæ</span>
        <span class="nav-title">Floofs Den</span>
      </div>
      <div class="nav-menu">
        <a href="/index.html#home" class="nav-link">Home</a>
        <a href="/index.html#features" class="nav-link">Features</a>
        <a href="/commands.html" class="nav-link active">Commands</a>
        <a href="/status.html" class="nav-link">Status</a>
        <a href="https://discord.gg/Acpx662Eyg" target="_blank" class="nav-link support-link">
          <i class="fab fa-discord"></i> Support
        </a>
      </div>
      <div class="nav-toggle">
        <span></span><span></span><span></span>
      </div>
    </div>
  </nav>

  <header class="page-hero">
    <div class="container">
      <h1 class="hero-title">Commands & Help</h1>
      <p class="hero-description">Clear, step-by-step usage for admins and users.</p>
    </div>
  </header>

  <main class="container" style="padding-top:24px; padding-bottom:48px">
    <!-- Commands Header Row -->
    <section id="explorer" class="doc-section" aria-label="Commands Explorer" style="position:relative;">
      <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:12px; position:relative;">
        <div style="display:flex; align-items:center; gap:12px;">
          <span class="qb-search" aria-hidden="true" style="pointer-events:none; opacity:.9; display:inline-flex; align-items:center; justify-content:center;">
            <i class="fa fa-image"></i>
          </span>
          <h2 style="margin:0; display:flex; align-items:center; gap:10px;">Commands
            <small class="muted" style="font-weight:400">Explore by category or search</small>
          </h2>
        </div>
        <button id="qb-search" class="qb-search" aria-label="Search commands" title="Search" type="button">
          <i class="fa fa-search"></i>
        </button>
        <div id="qb-search-pop" class="qb-popover" role="dialog" aria-label="Search commands" hidden>
          <input id="cx-search" type="text" placeholder="Search commands‚Ä¶" aria-label="Search commands" />
        </div>
      </div>

      <!-- Quick Navigation directly below header -->
      <nav aria-label="Quick navigation" style="margin-bottom:16px; position:relative;">
        <div class="quickbar" aria-label="Quick links">
          <div class="quickbar-scroll" role="tablist">
            <a class="cx-chip active" href="#" data-group="All"><span class="icon">üìö</span> All</a>
            <a class="cx-chip" href="#" data-group="Configuration"><span class="icon">‚öôÔ∏è</span> Configuration</a>
            <a class="cx-chip" href="#" data-group="Gambling"><span class="icon">üé≤</span> Gambling</a>
            <a class="cx-chip" href="#" data-group="Moderation"><span class="icon">üî®</span> Moderation</a>
            <a class="cx-chip" href="#" data-group="Fun"><span class="icon">üéâ</span> Fun</a>
            <a class="cx-chip" href="#" data-group="General"><span class="icon">üß∞</span> General</a>
            <a class="cx-chip" href="#" data-group="Voice"><span class="icon">üîä</span> Voice</a>
            <a class="cx-chip" href="#" data-group="Tickets"><span class="icon">üé´</span> Tickets</a>
            <a class="cx-chip" href="#" data-group="Roles"><span class="icon">üè∑Ô∏è</span> Roles</a>
            <a class="cx-chip" href="#" data-group="AFK"><span class="icon">üí§</span> AFK</a>
          </div>
        </div>
      </nav>
      <div class="cx-toolbar" style="display:none">
        <div id="cx-cat-chips" class="cx-chips" role="tablist" aria-label="Categories" style="display:none"></div>
        <div class="cx-search" style="display:none"></div>
      </div>
      <div id="cx-grid" class="cx-grid" aria-live="polite"></div>
    </section>

    <!-- Configuration (Admin) (moved up) -->
    <section id="configuration" class="doc-section">
      <h2>Configuration <span class="badge badge-admin">Admin</span></h2>
      <div id="count-configuration" class="section-count"></div>
      <div class="doc-grid">
        <div class="doc-card"><code>%config modlog #channel</code><p>Set moderation logs destination.</p></div>
        <div class="doc-card"><code>%config roles #channel</code><p>Set role selection/menu channel.</p></div>
        <div class="doc-card"><code>%config welcome #channel</code><p>Set welcome messages channel.</p></div>
        <div class="doc-card"><code>%config gambling #channel</code><p>Restrict gambling to a channel.</p></div>
        <div class="doc-card"><code>%config rulesmenu [#channel] [RoleName]</code><p>Post the rules/agree menu. Optional: give RoleName on agree.</p></div>
        <div class="doc-card"><code>%config colormenu [#channel]</code><p>Post the color roles selector menu.</p></div>
        <div class="doc-card"><code>%config prefix [symbol]</code><p>Change server default prefix (e.g. <code>!</code>).</p></div>
        <div class="doc-card"><code>%config userprefix @user [symbol]</code><p>Set a personal prefix for a user.</p></div>
        <div class="doc-card"><code>%config view</code><p>View all current settings.</p></div>
        <div class="doc-card"><code>%config reset [setting|all]</code><p>Reset a specific setting or all.</p></div>
      </div>
      <p class="muted">All config commands require Administrator and validate permissions.</p>
    </section>

    <!-- Category Sections -->
    <section id="gambling" class="doc-section">
      <h2>Gambling</h2>
      <div id="count-gambling" class="section-count"></div>
      <div id="grid-gambling" class="cx-grid" aria-live="polite"></div>
    </section>

    <section id="moderation" class="doc-section">
      <h2>Moderation</h2>
      <div id="count-moderation" class="section-count"></div>
      <div id="grid-moderation" class="cx-grid" aria-live="polite"></div>
    </section>

    <section id="fun" class="doc-section">
      <h2>Fun</h2>
      <div id="count-fun" class="section-count"></div>
      <div id="grid-fun" class="cx-grid" aria-live="polite"></div>
    </section>

    <section id="general" class="doc-section">
      <h2>General</h2>
      <div id="count-general" class="section-count"></div>
      <div id="grid-general" class="cx-grid" aria-live="polite"></div>
    </section>

    <section id="voice" class="doc-section">
      <h2>Voice (VC)</h2>
      <div id="count-voice" class="section-count"></div>
      <div id="grid-voice" class="cx-grid" aria-live="polite"></div>
    </section>

    <section id="roles-section" class="doc-section">
      <h2>Roles</h2>
      <div id="count-roles" class="section-count"></div>
      <div id="grid-roles" class="cx-grid" aria-live="polite"></div>
    </section>

    <section id="afk" class="doc-section">
      <h2>AFK</h2>
      <div id="count-afk" class="section-count"></div>
      <div id="grid-afk" class="cx-grid" aria-live="polite"></div>
    </section>

    <section id="tickets" class="doc-section">
      <h2>Tickets</h2>
      <div id="count-tickets" class="section-count"></div>
      <div id="grid-tickets" class="cx-grid" aria-live="polite"></div>
    </section>

    <!-- (Explorer section moved above under quickbar) -->
    <!-- Quick Help -->
    <section id="help" class="doc-section">
      <h2>Help</h2>
      <div class="doc-block">
        <h3>Prefix</h3>
        <p>
          Floof supports both a server default prefix and per-user prefixes.
        </p>
        <ul>
          <li><code>%help</code> ‚Äî Show the help menu with your current prefix.</li>
          <li><strong>Per-user prefix:</strong> You can have your own prefix that only you can use. Ask an admin to set it via <code>%config userprefix @you !</code>. After that, you can use <code>!help</code>, <code>!balance</code>, etc., without changing the server default.</li>
          <li><strong>Server default prefix (Admin):</strong> <code>%config prefix ?</code> changes the default prefix for everyone.</li>
        </ul>
        <p class="muted">Tip: You can always mention the bot to get help, e.g. <code>@Floof help</code>.</p>
      </div>
    </section>

    <!-- (moved sections above) -->

    <!-- Menus -->
    <section id="menus" class="doc-section">
      <h2>Menus</h2>
      <div class="doc-block">
        <h3>Rules / Agree Menu <span class="badge badge-admin">Admin</span></h3>
        <p>Use <code>%config rulesmenu [#channel]</code> to post. Members click the button to agree; optional auto-role if configured via <code>%config rulescontent role:"RoleName"</code>.</p>
        <ul>
          <li>Bot needs: <em>Send Messages</em>, <em>Embed Links</em>, <em>Add Reactions</em>, <em>Manage Roles</em> (if auto-role).</li>
          <li>Common errors: role hierarchy (bot must be above the role), missing permissions.</li>
        </ul>
      </div>
      <div class="doc-block">
        <h3>Color Roles Menu <span class="badge badge-admin">Admin</span></h3>
        <p>Use <code>%config colormenu [#channel]</code> to post a color selector. Members pick a color; bot assigns the corresponding role. If color roles don‚Äôt exist yet, the bot will create the set automatically.</p>
        <ul>
          <li>Bot needs <em>Manage Roles</em>, and its top role must be above the color roles.</li>
          <li>Roles are created once on first run; subsequent runs reuse them.</li>
        </ul>
      </div>
      <div class="doc-block">
        <h3>Custom Rules Content <span class="badge badge-admin">Admin</span></h3>
        <p>Customize the rules embed text, footer, button label, and assign role via quoted key-value pairs. <strong>Newlines:</strong> use <code>\n</code> inside quotes.</p>
        <pre class="code-block"><code>%config rulescontent title:"Server Rules"
description:"1. Be respectful\n2. No spam\n3. Follow Discord ToS"
footer:"Click I Agree to get access" button:"I Agree" role:"Member"</code></pre>
        <ul>
          <li>Set defaults: <code>%config ruleschannel #rules</code>. Post using: <code>%config rulesmenu</code>.</li>
          <li>Update any single field at any time (e.g., just the footer or button label).</li>
          <li>Reset content: <code>%config reset rulescontent</code></li>
        </ul>
      </div>
    </section>

    <!-- Leveling -->
    <section id="leveling" class="doc-section">
      <h2>Leveling</h2>
      <div class="doc-grid">
        <div class="doc-card"><code>%levels</code><p>Show your XP/level progress.</p></div>
        <div class="doc-card"><code>%levels @user</code><p>View another user‚Äôs progress.</p></div>
        <div class="doc-card"><code>%levels leaderboard</code><p>Top XP leaderboard.</p></div>
        <div class="doc-card"><code>%levels config</code> <span class="badge badge-admin">Admin</span><p>Configure leveling (channels, rates, rewards).</p></div>
        <div class="doc-card"><code>%levels reset @user</code> <span class="badge badge-admin">Admin</span><p>Reset a user‚Äôs XP/level.</p></div>
        <div class="doc-card"><code>%levels reset all</code> <span class="badge badge-admin">Admin</span><p>Reset everyone‚Äôs XP/levels.</p></div>
      </div>
      <p class="muted">Spam protection prevents abuse; XP is rate-limited.</p>
    </section>

    

    <!-- Roles -->
    <section id="roles" class="doc-section">
      <h2>Roles</h2>
      <div class="doc-grid">
        <div class="doc-card"><code>%createrole [name]</code><p>Create a new role.</p></div>
        <div class="doc-card"><code>%deleterole [name]</code><p>Delete a role.</p></div>
        <div class="doc-card"><code>%giverole @user [role]</code><p>Give a user a role.</p></div>
        <div class="doc-card"><code>%takerole @user [role]</code><p>Remove a role from a user.</p></div>
        <div class="doc-card"><code>%listroles</code><p>List all roles.</p></div>
      </div>
      <p class="muted">For role changes, the bot‚Äôs top role must be higher than the target role.</p>
    </section>

    <!-- Troubleshooting -->
    <section id="troubleshooting" class="doc-section">
      <h2>Troubleshooting</h2>
      <ul>
        <li><strong>Bot can‚Äôt post:</strong> Check channel permissions (Send Messages, Embed Links).</li>
        <li><strong>Role not assigned:</strong> Ensure bot role is above the target role and bot has Manage Roles.</li>
        <li><strong>Commands not responding:</strong> Confirm prefix (server default or your per-user prefix) and try <code>@Floof help</code>.</li>
      </ul>
    </section>
  </main>
  
  <!-- Back to Top Button -->
  <button id="back-to-top" aria-label="Back to top" title="Back to top">
    <i class="fa fa-arrow-up"></i>
  </button>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <div class="footer-brand"><span class="footer-logo">üêæ</span><span class="footer-title">Floofs Den</span></div>
          <p>Making Discord servers more fun, one command at a time.</p>
        </div>
        <div class="footer-section">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="/index.html#features">Features</a></li>
            <li><a href="/commands.html">Commands</a></li>
            <li><a href="/status.html">API Status</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Support</h4>
          <ul>
            <li><a href="https://discord.gg/Acpx662Eyg">Discord Server</a></li>
            <li><a href="mailto:support@floofbot.com">Contact Us</a></li>
            <li><a href="/privacy">Privacy Policy</a></li>
            <li><a href="/terms">Terms of Service</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Connect</h4>
          <div class="social-links">
            <a href="#" class="social-link"><i class="fab fa-discord"></i></a>
            <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
            <a href="#" class="social-link"><i class="fab fa-github"></i></a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2024 Floofs Den. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="/script.js"></script>
  <style>
    /* lightweight doc styles that reuse your theme */
    .page-hero { padding: 64px 0 24px; background: linear-gradient(180deg, var(--bg-gradient-start), transparent); }
    .doc-section { margin-bottom: 36px; }
    .doc-grid { display: grid; gap: 12px; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); }
    .doc-card { border: 1px solid var(--border-color); border-radius: 12px; padding: 12px; background: var(--surface-color); }
    .doc-block { border: 1px solid var(--border-color); border-radius: 12px; padding: 14px; background: var(--surface-color); margin-bottom: 12px; }
    .badge { display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: 12px; font-weight: 600; margin-left: 6px; }
    .badge-admin { background: #e3d1ff20; color: #b18cff; border: 1px solid #b18cff60; }
    .doc-card code, .doc-block code { background: var(--chip-bg, #00000010); padding: 2px 6px; border-radius: 8px; }
    /* Explorer */
    .cx-toolbar { display:flex; gap:12px; align-items:center; justify-content:space-between; margin-bottom:12px; flex-wrap:wrap; }
    .cx-chips { display:flex; gap:8px; overflow-x:auto; padding:6px 4px; scrollbar-width: thin; }
    .cx-chips::-webkit-scrollbar { height: 8px; }
    .cx-chips::-webkit-scrollbar-track { background: transparent; }
    .cx-chips::-webkit-scrollbar-thumb { background: #00000030; border-radius: 999px; }
    .cx-chip { white-space:nowrap; padding:6px 12px; border-radius:999px; border:1px solid var(--border-color); background: var(--surface-color); color: var(--text-color); cursor:pointer; display:flex; align-items:center; gap:8px; }
    .cx-chip.active { background: linear-gradient(180deg, #9b8cff33, #9b8cff22); border-color:#b18cff66; }
    .cx-chip .count { font-weight:700; font-size:11px; padding:2px 6px; border-radius:999px; background:#00000020; border:1px solid var(--border-color); }
    .cx-search input { padding:8px 10px; border-radius:10px; border:1px solid var(--border-color); background: var(--surface-color); color: var(--text-color); min-width:220px; }
    .cx-grid { display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); }
    .cx-card { border:1px solid var(--border-color); border-radius:12px; background: var(--surface-color); padding:12px; display:flex; flex-direction:column; gap:8px; }
    .cx-card h4 { margin:0; font-size:16px; }
    .cx-meta { display:flex; flex-wrap:wrap; gap:6px; font-size:12px; color:var(--muted-color); }
    .cx-badge { padding:2px 8px; border-radius:999px; border:1px solid var(--border-color); background: var(--bg-color); font-weight:600; font-size:11px; }
    .cx-badge.admin { background:#e3d1ff20; border-color:#b18cff60; color:#b18cff; }
    .cx-badge.mod { background:#ffd9a820; border-color:#ffb34760; color:#ff9a00; }
    .cx-badge.perm { background:#90cdf420; border-color:#63b3ed60; color:#63b3ed; }
    .cx-args, .cx-aliases, .cx-perms { font-size:13px; }
    .cx-args strong, .cx-aliases strong, .cx-perms strong { color: var(--text-color); text-transform: lowercase; font-weight:700; }
    .cx-args-list, .cx-alias-list, .cx-perms-list { display:flex; flex-wrap:wrap; gap:6px; margin:6px 0 0; padding:0; list-style:none; }
    .cx-args-list li { border:1px dashed var(--border-color); padding:2px 8px; border-radius:10px; font-size:12px; }
    .cx-alias-list li, .cx-perms-list li { background:#00000020; border:1px solid var(--border-color); padding:2px 8px; border-radius:999px; font-size:12px; }
    .code-block { white-space:pre-wrap; background: var(--surface-color); border:1px solid var(--border-color); border-radius:10px; padding:10px; }
    /* Back to Top */
    #back-to-top {
      position: fixed; right: 20px; bottom: 20px; z-index: 50;
      width: 42px; height: 42px; border-radius: 999px;
      display: inline-flex; align-items: center; justify-content: center;
      background: #ffffff; color: #4b5563; border: 1px solid rgba(0,0,0,0.12);
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      cursor: pointer; opacity: 0; pointer-events: none; transition: opacity .2s ease, transform .2s ease;
    }
    #back-to-top.show { opacity: 1; pointer-events: auto; }
    #back-to-top:hover { transform: translateY(-2px); background:#f7f7f9; }
  </style>
  <script>
    // Commands data (concise; expand as needed)
    const COMMANDS = [
      // Gambling
      { name:'balance', desc:'View your current coins.', cat:'gambling' },
      { name:'beg', desc:'Chance to receive a small coin reward.', cat:'gambling' },
      { name:'work', desc:'Earn coins on a cooldown.', cat:'gambling' },
      { name:'slots [amount]', desc:'Slot machine with wins/losses based on symbols.', cat:'gambling', aliases:['slot'] },
      { name:'coinflip [amount] [heads|tails]', desc:'50/50 coin toss bet.', cat:'gambling' },
      { name:'blackjack [amount]', desc:'Play blackjack vs the dealer.', cat:'gambling' },
      { name:'roulette [amount] [color|number]', desc:'Bet on red/black/green or a number.', cat:'gambling' },
      { name:'donate @user [amount]', desc:'Send coins to another user.', cat:'gambling' },
      { name:'leaderboard', desc:'See top balances.', cat:'gambling' },
      { name:'levels', desc:'Check XP/leveling progress.', cat:'gambling' },
      { name:'release', desc:'Claim periodic release rewards.', cat:'gambling' },
      { name:'beatup [@user]', desc:'Fun combat-themed coin interaction.', cat:'gambling' },

      // Moderation / Configuration
      { name:'config modlog #channel', desc:'Set moderation logs channel.', cat:'configuration', roles:['Admin'], perms:['Administrator'] },
      { name:'config roles #channel', desc:'Set role selection/menu channel.', cat:'configuration', roles:['Admin'], perms:['Administrator'] },
      { name:'config welcome #channel', desc:'Set welcome channel.', cat:'configuration', roles:['Admin'], perms:['Administrator'] },
      { name:'config gambling #channel', desc:'Restrict gambling to a channel.', cat:'configuration', roles:['Admin'], perms:['Administrator'] },
      { name:'config ruleschannel #channel', desc:'Default channel for rules menu.', cat:'configuration', roles:['Admin'], perms:['Administrator'] },
      { name:'config colorschannel #channel', desc:'Default channel for color menu.', cat:'configuration', roles:['Admin'], perms:['Administrator'] },
      { name:'config rulescontent ...', desc:'Customize rules title/description/footer/button/role (use \\n for new lines).', cat:'configuration', roles:['Admin'], perms:['Administrator'] },
      { name:'config colorcontent ...', desc:'Customize color menu title/description.', cat:'configuration', roles:['Admin'], perms:['Administrator'] },
      { name:'config rulesmenu [#channel]', desc:'Post rules/agree menu (uses defaults).', cat:'configuration', roles:['Admin'], perms:['Administrator'] },
      { name:'config colormenu [#channel]', desc:'Auto-create color roles if missing; post color selector.', cat:'configuration', roles:['Admin'], perms:['Administrator'] },
      { name:'config view', desc:'View all current settings.', cat:'configuration', roles:['Admin'] },
      { name:'config reset [setting|all]', desc:'Reset a specific setting or all.', cat:'configuration', roles:['Admin'], perms:['Administrator'] },

      // Moderation
      { name:'ban @user [reason]', desc:'Ban a user.', cat:'moderation', roles:['Admin'], perms:['Ban Members'], args:['user','reason'], aliases:['banish'] },
      { name:'kick @user [reason]', desc:'Kick a user.', cat:'moderation', roles:['Admin'], perms:['Kick Members'], args:['user','reason'] },
      { name:'timeout @user [duration] [reason]', desc:'Timeout a user.', cat:'moderation', roles:['Mod'], perms:['Moderate Members'], args:['user','duration','reason'], aliases:['mute','tm'] },
      { name:'warn @user [reason]', desc:'Warn a user; logs to infractions.', cat:'moderation', roles:['Mod'], perms:['Manage Messages'], args:['user','reason'], aliases:['strike'] },
      { name:'infractions @user', desc:'View a user\'s infractions.', cat:'moderation', roles:['Mod'] },
      { name:'clearinfractions @user', desc:'Clear a user\'s infractions.', cat:'moderation', roles:['Admin'], args:['user'] },
      { name:'slowmode [seconds]', desc:'Set channel slowmode.', cat:'moderation', roles:['Mod'], perms:['Manage Channels'], args:['seconds'] },
      { name:'purge [1-100]', desc:'Bulk delete recent messages.', cat:'moderation', roles:['Mod'], perms:['Manage Messages'], args:['count'], aliases:['clear','prune'] },
      { name:'advancedlog', desc:'Advanced logging configuration.', cat:'moderation', roles:['Mod'], perms:['Manage Server'] },
      { name:'createlevelroles [start] [end]', desc:'Create level roles automatically.', cat:'moderation', roles:['Admin'] },

      // Fun
      { name:'8ball', desc:'Ask the magic 8ball.', cat:'fun' },
      { name:'bite', desc:'Bite another user (fun).', cat:'fun' },
      { name:'blush', desc:'Blush at someone.', cat:'fun' },
      { name:'cat', desc:'Random cat image.', cat:'fun' },
      { name:'dance', desc:'Dance!', cat:'fun' },
      { name:'highfive', desc:'Give a high five.', cat:'fun' },
      { name:'hug', desc:'Give a hug.', cat:'fun' },
      { name:'joke', desc:'Tell a joke.', cat:'fun' },
      { name:'kiss', desc:'Give a kiss.', cat:'fun' },
      { name:'pat', desc:'Pat someone.', cat:'fun' },
      { name:'poll', desc:'Create a poll.', cat:'fun' },
      { name:'roll', desc:'Roll dice.', cat:'fun' },
      { name:'shoot', desc:'Shoot (fun).', cat:'fun' },
      { name:'slap', desc:'Slap (fun).', cat:'fun' },
      { name:'wave', desc:'Wave!', cat:'fun' },

      // General
      { name:'help', desc:'Show help.', cat:'general' },
      { name:'snipe', desc:'Retrieve last deleted message in channel.', cat:'general', perms:['Manage Messages'], args:['channel?','index?'], aliases:['sn'] },
      { name:'snipe embed', desc:'Snipe past embeds in the channel.', cat:'general', perms:['Manage Messages'], args:['channel?'] },
      { name:'snipe bulk', desc:'List all recorded snipes in the past for a channel.', cat:'general', perms:['Manage Messages'], args:['channel?'] },
      { name:'snipe user', desc:"Snipe a user's past deleted messages from a channel.", cat:'general', perms:['Manage Messages'], args:['user','channel?'] },
      { name:'snipe search', desc:'Search past snipes by text.', cat:'general', perms:['Manage Messages'], args:['text'] },
      { name:'bulksnipe', desc:'Show list of recently deleted messages.', cat:'general', roles:['Mod'] },
      { name:'clearsnipe', desc:'Clear snipe cache.', cat:'general', roles:['Mod'] },
      { name:'remind', desc:'Set a reminder.', cat:'general' },
      { name:'revive', desc:'Ping a revive role with a question.', cat:'general', perms:['Manage Channels'], aliases:['re'] },
      { name:'voice', desc:'Manage temporary voice channels.', cat:'voice', roles:['Mod'], perms:['Manage Channels'], args:['subcommand','...'] },
      { name:'analytics', desc:'Server analytics.', cat:'general', roles:['Mod'] },

      // Voice (VC)
      { name:'vcconfig set #category', desc:'Set category for temporary voice channels.', cat:'voice', roles:['Mod'], perms:['Manage Channels'], args:['category'] },
      { name:'vcconfig clear', desc:'Clear VC category configuration.', cat:'voice', roles:['Mod'], perms:['Manage Channels'] },
      { name:'vcconfig view', desc:'View VC category configuration.', cat:'voice' },
      { name:'voice help', desc:'Show voice command help.', cat:'voice' },
      { name:'voice name <new name>', desc:'Rename your temporary VC.', cat:'voice', args:['name'] },
      { name:'voice reject @user', desc:'Remove access for a user.', cat:'voice', args:['user'] },
      { name:'voice allow @user', desc:'Grant access for a user.', cat:'voice', args:['user'] },
      { name:'voice limit <n>', desc:'Set user limit for your VC.', cat:'voice', args:['n'] },
      { name:'voice transfer @user', desc:'Transfer VC ownership.', cat:'voice', args:['user'] },

      // Tickets
      { name:'ticket', desc:'Ticket system menu and actions.', cat:'tickets', roles:['Mod'], perms:['Manage Server'] },
      { name:'ticket create', desc:'Create a support ticket.', cat:'tickets' },
      { name:'ticket claim', desc:'Claim the current ticket.', cat:'tickets' },
      { name:'ticket close', desc:'Close the current ticket.', cat:'tickets', aliases:['delete'] },
      { name:'ticket setup', desc:'Configure ticket system.', cat:'tickets', roles:['Admin'] },
      { name:'ticket config', desc:'Alias of setup.', cat:'tickets', aliases:['setup'] },
      { name:'ticket category #category', desc:'Set ticket category.', cat:'tickets', roles:['Admin'], args:['category'] },
      { name:'ticket staff add @role|@user', desc:'Allow staff to claim.', cat:'tickets', roles:['Admin'], args:['role|user'] },
      { name:'ticket staff remove @role|@user', desc:'Remove staff member.', cat:'tickets', roles:['Admin'], args:['role|user'] },
      { name:'ticket log #channel', desc:'Set ticket logs channel.', cat:'tickets', roles:['Admin'], args:['channel'] },
      { name:'ticket view', desc:'View ticket configuration.', cat:'tickets' },
      { name:'ticket list', desc:'List open tickets.', cat:'tickets' },
      { name:'ticket transcript', desc:'Generate ticket transcript.', cat:'tickets' },

      // Roles
      { name:'createrole [name]', desc:'Create a role.', cat:'roles', roles:['Mod'], perms:['Manage Roles'], args:['name'], aliases:['addrole','ar'] },
      { name:'deleterole [name]', desc:'Delete a role.', cat:'roles', roles:['Mod'], perms:['Manage Roles'], args:['name'] },
      { name:'giverole @user [role]', desc:'Give a role to a user.', cat:'roles', roles:['Mod'], perms:['Manage Roles'], args:['user','role'] },
      { name:'takerole @user [role]', desc:'Remove a user\'s role.', cat:'roles', roles:['Mod'], perms:['Manage Roles'], args:['user','role'], aliases:['removerole','rr'] },
      { name:'listroles', desc:'List all roles.', cat:'roles' },

      // AFK
      { name:'afk [reason]', desc:'Set your AFK status.', cat:'afk' },

      // Extra Moderation (missing previously)
      { name:'av [@user]', desc:'View a user\'s avatar (server/user).', cat:'moderation' },
      { name:'whois @user', desc:'Show detailed user information.', cat:'moderation' },
    ];

    const grid = document.getElementById('cx-grid');
    const catChips = document.getElementById('cx-cat-chips');
    const search = document.getElementById('cx-search');

    // Map internal categories to display groups matching our sections
    const GROUP_MAP = {
      configuration: 'Configuration',
      gambling: 'Gambling',
      moderation: 'Moderation',
      fun: 'Fun',
      general: 'General',
      roles: 'Roles',
      afk: 'AFK',
      voice: 'Voice',
      tickets: 'Tickets'
    };

    function getGroup(c){ return c.group || GROUP_MAP[c.cat] || 'Miscellaneous'; }

    function computeGroupCounts(){
      const counts = {};
      for(const c of COMMANDS){ const g = getGroup(c); counts[g] = (counts[g]||0)+1; }
      const total = COMMANDS.length;
      return { counts, total };
    }

    function buildCategoryChips(){
      // Keep Explorer's internal chips hidden (we now control via top quickbar)
      catChips.innerHTML = '';
    }

    function makeCard(c){
      const card = document.createElement('div');
      card.className = 'cx-card';
      const title = document.createElement('h4');
      title.textContent = c.name.startsWith('%') ? c.name : `%${c.name}`;
      const desc = document.createElement('div');
      desc.textContent = c.desc;
      const meta = document.createElement('div');
      meta.className = 'cx-meta';
      const cat = document.createElement('span'); cat.className='cx-badge'; cat.textContent = c.cat;
      meta.appendChild(cat);
      if(Array.isArray(c.roles)){
        for(const r of c.roles){
          const role = document.createElement('span');
          role.className = 'cx-badge ' + (r==='Admin' ? 'admin' : 'mod');
          role.textContent = r;
          meta.appendChild(role);
        }
      }
      if(Array.isArray(c.perms)){
        for(const p of c.perms){
          const perm = document.createElement('span');
          perm.className = 'cx-badge perm';
          perm.textContent = p;
          meta.appendChild(perm);
        }
      }
      // Arguments block
      const argsWrap = document.createElement('div');
      argsWrap.className = 'cx-args';
      {
        const argsTitle = document.createElement('div');
        argsTitle.innerHTML = '<strong>arguments</strong>';
        const ul = document.createElement('ul');
        ul.className = 'cx-args-list';
        const list = Array.isArray(c.args) ? c.args : [];
        if(list.length){
          for(const a of list){ const li = document.createElement('li'); li.textContent = a; ul.appendChild(li); }
        } else {
          const li = document.createElement('li'); li.textContent = 'None'; ul.appendChild(li);
        }
        argsWrap.appendChild(argsTitle);
        argsWrap.appendChild(ul);
      }
      // Aliases block
      const aliasesWrap = document.createElement('div');
      aliasesWrap.className = 'cx-aliases';
      if(Array.isArray(c.aliases) && c.aliases.length){
        const alTitle = document.createElement('div');
        alTitle.innerHTML = '<strong>aliases</strong>';
        const ulA = document.createElement('ul');
        ulA.className = 'cx-alias-list';
        for(const al of c.aliases){
          const li = document.createElement('li');
          li.textContent = al;
          ulA.appendChild(li);
        }
        aliasesWrap.appendChild(alTitle);
        aliasesWrap.appendChild(ulA);
      }
      // Permissions line
      const permsLine = document.createElement('div');
      permsLine.className = 'cx-perms';
      const permsTitle = document.createElement('div');
      permsTitle.innerHTML = '<strong>permissions</strong>';
      const ulP = document.createElement('ul');
      ulP.className = 'cx-perms-list';
      const permsList = Array.isArray(c.perms) ? c.perms : [];
      if(permsList.length){
        for(const p of permsList){ const li = document.createElement('li'); li.textContent = p; ulP.appendChild(li); }
      } else {
        const li = document.createElement('li'); li.textContent = 'None'; ulP.appendChild(li);
      }
      permsLine.appendChild(permsTitle);
      permsLine.appendChild(ulP);
      card.appendChild(title); card.appendChild(desc); card.appendChild(meta);
      if(argsWrap.childNodes.length) card.appendChild(argsWrap);
      if(aliasesWrap.childNodes.length) card.appendChild(aliasesWrap);
      card.appendChild(permsLine);
      return card;
    }

    function render(filterGroup='All', query=''){
      grid.innerHTML = '';
      const q = query.trim().toLowerCase();
      const items = COMMANDS.filter(c => (filterGroup==='All' || getGroup(c)===filterGroup) && (!q || (c.name.toLowerCase().includes(q) || c.desc.toLowerCase().includes(q))));
      for(const c of items){ grid.appendChild(makeCard(c)); }
      if(items.length===0){
        const empty = document.createElement('div');
        empty.className='muted';
        empty.textContent='No commands match your filters.';
        grid.appendChild(empty);
      }
    }

    function renderInto(containerId, filterCat){
      const container = document.getElementById(containerId);
      if(!container) return;
      container.innerHTML = '';
      const items = COMMANDS.filter(c => c.cat === filterCat);
      for(const c of items){ container.appendChild(makeCard(c)); }
    }

    function setSectionCount(elId, cat){
      const el = document.getElementById(elId);
      if(!el) return;
      const n = COMMANDS.filter(c => c.cat === cat).length;
      el.textContent = n ? `${n} command${n!==1?'s':''}` : '';
    }

    function updateSectionCounts(){
      setSectionCount('count-configuration','configuration');
      setSectionCount('count-gambling','gambling');
      setSectionCount('count-moderation','moderation');
      setSectionCount('count-fun','fun');
      setSectionCount('count-general','general');
      setSectionCount('count-roles','roles');
      setSectionCount('count-afk','afk');
      setSectionCount('count-voice','voice');
      setSectionCount('count-tickets','tickets');
      
    }

    catChips.addEventListener('click', (e) => {
      const btn = e.target.closest('button.cx-chip');
      if(!btn) return;
      for(const b of catChips.querySelectorAll('button.cx-chip')) b.classList.remove('active');
      btn.classList.add('active');
      render(btn.dataset.group || 'All', search.value);
    });
    search.addEventListener('input', () => {
      const active = document.querySelector('.cx-chip.active');
      render(active?.dataset.group || 'All', search.value);
    });
    // Helper: show only the selected category section (or all)
    function setVisibleSections(group){
      const explorer = document.getElementById('explorer');
      if(explorer) explorer.style.display = '';
      const explorerGrid = document.getElementById('cx-grid');
      if(explorerGrid) explorerGrid.style.display = (group === 'All') ? '' : 'none';

      const sections = [
        { id:'configuration', group:'Configuration' },
        { id:'gambling', group:'Gambling' },
        { id:'moderation', group:'Moderation' },
        { id:'fun', group:'Fun' },
        { id:'general', group:'General' },
        { id:'voice', group:'Voice' },
        { id:'tickets', group:'Tickets' },
        { id:'afk', group:'AFK' },
        { id:'roles-section', group:'Roles' },
        // Non-category informational sections
        // Show Roles docs alongside the Roles grid when Roles is selected
        { id:'roles', group:'Roles' },
        { id:'help', group:'All' },
        { id:'menus', group:'All' },
        { id:'leveling', group:'All' },
        { id:'troubleshooting', group:'All' }
      ];
      for(const {id, group:grp} of sections){
        const el = document.getElementById(id);
        if(!el) continue;
        const show = (group === 'All') || (group === grp);
        el.style.display = show ? '' : 'none';
      }
      // No auto-scrolling; keep the view stable per user preference
    }

    // Initial render (default to All)
    render('All');
    renderInto('grid-gambling', 'gambling');
    renderInto('grid-moderation', 'moderation');
    renderInto('grid-fun', 'fun');
    renderInto('grid-general', 'general');
    renderInto('grid-roles', 'roles');
    renderInto('grid-afk', 'afk');
    renderInto('grid-voice', 'voice');
    renderInto('grid-tickets', 'tickets');
    setVisibleSections('All');
    updateSectionCounts();

    // Quickbar active state (top nav chips)
    const quickbarScroll = document.querySelector('.quickbar-scroll');
    if (quickbarScroll){
      // Prevent native link-drag initiating a navigation drag image
      quickbarScroll.querySelectorAll('a.cx-chip').forEach(a=> a.setAttribute('draggable','false'));
      quickbarScroll.addEventListener('dragstart', (e)=>{ e.preventDefault(); });
      // Active state on click (only if not dragging)
      let dragging = false;
      let startX = 0;
      let scrollStart = 0;
      let moved = 0;

      function onDown(clientX){
        dragging = true; moved = 0;
        startX = clientX; scrollStart = quickbarScroll.scrollLeft;
        quickbarScroll.classList.add('dragging');
      }
      function onMove(clientX){
        if(!dragging) return;
        const dx = clientX - startX;
        moved = Math.max(moved, Math.abs(dx));
        quickbarScroll.scrollLeft = scrollStart - dx;
      }
      function onUp(){ dragging = false; quickbarScroll.classList.remove('dragging'); }

      // Mouse
      quickbarScroll.addEventListener('mousedown', (e)=>{ if(e.button!==0) return; onDown(e.clientX); });
      window.addEventListener('mousemove', (e)=> onMove(e.clientX));
      window.addEventListener('mouseup', onUp);

      // Touch
      quickbarScroll.addEventListener('touchstart', (e)=>{ if(!e.touches[0]) return; onDown(e.touches[0].clientX); }, {passive:true});
      quickbarScroll.addEventListener('touchmove', (e)=>{ if(!e.touches[0]) return; onMove(e.touches[0].clientX); }, {passive:true});
      quickbarScroll.addEventListener('touchend', onUp);

      // Click selects group (unless we dragged)
      quickbarScroll.addEventListener('click', (e)=>{
        const a = e.target.closest('a.cx-chip');
        if(!a) return;
        e.preventDefault();
        if(moved > 5){ return; }
        for(const el of quickbarScroll.querySelectorAll('a.cx-chip')) el.classList.remove('active');
        a.classList.add('active');
        const group = a.dataset.group || 'All';
        render(group, search.value);
        setVisibleSections(group);
      }, true);
    }
    // Search popover toggle
    const qbSearchBtn = document.getElementById('qb-search');
    const qbPop = document.getElementById('qb-search-pop');
    function hidePop(){ if(!qbPop) return; qbPop.hidden = true; }
    function showPop(){ if(!qbPop) return; qbPop.hidden = false; const inp = qbPop.querySelector('#cx-search'); inp && inp.focus(); }
    if(qbSearchBtn && qbPop){
      qbSearchBtn.addEventListener('click', (e)=>{ e.stopPropagation(); qbPop.hidden ? showPop() : hidePop(); });
      document.addEventListener('click', (e)=>{ if(qbPop.hidden) return; if(!qbPop.contains(e.target) && e.target !== qbSearchBtn) hidePop(); });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') hidePop(); });
    }

    // Back to Top behavior
    (function(){
      const btn = document.getElementById('back-to-top');
      if(!btn) return;
      function onScroll(){
        if(window.scrollY > 600) btn.classList.add('show'); else btn.classList.remove('show');
      }
      window.addEventListener('scroll', onScroll, { passive: true });
      btn.addEventListener('click', () => { window.scrollTo({ top: 0, behavior: 'smooth' }); });
      onScroll();
    })();
  </script>
</body>
</html>
